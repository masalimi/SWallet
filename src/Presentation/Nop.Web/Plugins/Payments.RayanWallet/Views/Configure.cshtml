@using Nop.Plugin.Payments.RayanWallet.Models
@using Nop.Web.Framework.Models.DataTables
@model Nop.Plugin.Payments.RayanWallet.Models.ConfigurationModel
@{
    Layout = "_ConfigurePlugin";
}
@await Component.InvokeAsync("StoreScopeConfiguration")
<form asp-controller="PaymentRayanWallet" asp-action="Configure" method="post" id="payment-wallet-form">
    <div class="panel-group">
        <div class="panel panel-default">
            <div class="panel-body">
                <p>@T("Plugins.Payments.RayanWallet.Instructions")</p>

                <div class="form-group">
                    <div class="col-md-3">
                        <nop-override-store-checkbox asp-for="BaseUrl_OverrideForStore" asp-input="BaseUrl" asp-store-scope="@Model.ActiveStoreScopeConfiguration" />
                        <nop-label asp-for="BaseUrl" />
                    </div>
                    <div class="col-md-9">
                        <nop-editor asp-for="BaseUrl" />
                        <span asp-validation-for="BaseUrl"></span>
                    </div>
                </div>


                <div class="form-group">
                    <div class="col-md-3">
                        <nop-override-store-checkbox asp-for="Authorization_OverrideForStore" asp-input="Authorization" asp-store-scope="@Model.ActiveStoreScopeConfiguration" />
                        <nop-label asp-for="Authorization" />
                    </div>
                    <div class="col-md-9">
                        <nop-textarea asp-for="Authorization" />
                        <span asp-validation-for="Authorization"></span>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-3">
                        <nop-override-store-checkbox asp-for="RefCode_OverrideForStore" asp-input="RefCode" asp-store-scope="@Model.ActiveStoreScopeConfiguration" />
                        <nop-label asp-for="RefCode" />
                    </div>
                    <div class="col-md-9">
                        <nop-editor asp-for="RefCode" />
                        <span asp-validation-for="RefCode"></span>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-3">
                        <nop-override-store-checkbox asp-for="UseToman_OverrideForStore" asp-input="UseToman" asp-store-scope="@Model.ActiveStoreScopeConfiguration" />
                        <nop-label asp-for="UseToman" />
                    </div>
                    <div class="col-md-9">
                        <nop-editor asp-for="UseToman" />
                        <span asp-validation-for="UseToman"></span>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-9 col-md-offset-3">
                        <input type="submit" name="save" class="btn bg-primary" value="@T("Admin.Common.Save")" />
                        @*<button type="submit" id="btnAddNewRecord" class="btn btn-primary"
                                    onclick="javascript:OpenWindow('@Url.Action("AddWalletCustomerPopup", "PaymentRayanWallet", new {btnId = "btnRefresh", formId = "payment-wallet-form"})', 800, 800, true);return false;">
                                @T("Plugins.Shipping.FixedByWeightByTotal.AddRecord")
                            </button>*@
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="panel-group">
        <div class="panel panel-default">
            <div class="panel-body">
                <div class="form-group">
                    <div class="col-md-9 col-md-offset-3">
                        <button type="submit" id="btnAddNewRecord" class="btn btn-primary"
                                onclick="javascript:OpenWindow('@Url.Action("AddWalletCustomerPopup", "PaymentRayanWallet", new {btnId = "btnRefresh", formId = "payment-wallet-form"})', 800, 800, true);return false;">
                            @T("Plugins.Shipping.FixedByWeightByTotal.AddRecord")
                        </button>
                        <input type="submit" id="btnRefresh" class="btn btn-default" style="display: none" />
                    </div>
                </div>
                @await Html.PartialAsync("Table", new DataTablesModel
           {
               Name = "wallet-list-grid",
               UrlRead = new DataUrl("WalletCustomerList", "PaymentRayanWallet", null),
               //UrlDelete = new DataUrl("DeleteWallet", "PaymentRayanWallet", null),
               Length = Model.PageSize,
               LengthMenu = Model.AvailablePageSizes,
               ColumnCollection = new List<ColumnProperty>
                           {
                           new ColumnProperty(nameof(WalletCustomerModel.UserName))
                           {
                               Title = T("Plugins.Payments.RayanWallet.UserName").Text,
                               Width = "200"
                           },
                           new ColumnProperty(nameof(WalletCustomerModel.Amount))
                           {
                               Title = T("Plugins.Payments.RayanWallet.Amount").Text,
                               Width = "200"
                           },
                            new ColumnProperty(nameof(WalletCustomerModel.Active))
                           {
                               Title = T("Plugins.Payments.RayanWallet.Active").Text,
                               Width = "200"
                           },
                           new ColumnProperty(nameof(WalletCustomerModel.Id))
                           {
                               Title = T("Admin.Common.Edit").Text,
                               ClassName = NopColumnClassDefaults.Button,
                               Width = "100",
                               Render = new RenderCustom("renderColumnEdit")
                           },
                           //new ColumnProperty(nameof(WalletCustomerModel.Id))
                           //{
                           //    Title = T("Admin.Common.Delete").Text,
                           //    ClassName = NopColumnClassDefaults.Button,
                           //    Render = new RenderButtonRemove(T("Admin.Common.Delete").Text),
                           //    Width = "100"
                           //}
                       }
           })
            </div>
        </div>
    </div>
    <script>
        $(document)
            .ready(function () {
                $('#btnRefresh')
                    .click(function () {
                        //refresh grid
                        updateTable('#wallet-list-grid');

                        //return false to don't reload a page
                        return false;
                    });
            });
        function renderColumnEdit(data, type, row, meta) {
        return '<button onclick=\"javascript:OpenWindow(\'@Url.Action("EditWalletPaymentUser", "PaymentRayanWallet")?id=' +
            data +
            '&btnId=btnRefresh&formId=payment-wallet-form\', 800, 800, true); return false;\" class="btn btn-default"><i class="fa fa-pencil"></i>@T("Admin.Common.Edit")</button>';
    }

    </script>
</form>
<nop-alert asp-alert-id="saveModeAlert" asp-alert-message="@T("Admin.Common.Alert.Save.Error")" />